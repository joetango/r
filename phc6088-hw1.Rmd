---
title: "PHC6088 Homework 1"
author: "Joe Dickerson"
date: "2026-01-31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, echo=FALSE}

#packages
library(tidyverse)
library(gridExtra)

```

## 1.

Answer: B, BbCc

Because the albino mouse has phenotype cc, we expect Cc in the non-albino parent as half of the children are albino, and half not. The albino mouse has bb at the B locus, and with one black and one brown offspring we expect Bb, accounting for half the non-albino offpsring to be brown, and the other half of the non-albino offspring to be black.

## 2a.

First, we simulate our genotypes over 100 generations with a population growth rate of 2.15 and run the simulations with sample size 500 and 5000. "n" represents the population size for each generation, while allele.freq represents the allele frequency. We expect to see the allele frequency closer to 1/2 as the population size increases. 

```{r, warning=FALSE}

gens <- 100

simulation <- function(n.0, offspring.rate = 2.15) {
  n <- numeric(gens)
  a.freq <- numeric(gens)
  
  #starting condition
  n[1] <- n.0
  a.freq[1] <- 0.5 
  
  for (i in 2:gens){
    #population increase
    n[i] <- round(n[i - 1] * offspring.rate/2) * 2
    
    totals <- 2 * n[i]
    
    #sampling
    a.count <- rbinom(1, totals, a.freq[i - 1])
    a.freq[i] <- a.count / totals
  }
  
  #constructing data frame
  data.frame(generation = 1:gens, n= n, allele.freq = a.freq) 
}

set.seed(5)

sim.500  <- simulation(500)
sim.5000 <- simulation(5000)

```


We plot the findings and examine the allele frequencies. The red line represents sample size 500, and the blue line represents sample size 5000. As expected, we see the allele frequency trend closer to 1/2 with the larger sample size. We also see larger variation at the lower generation values with smaller sample size. This is what we expect based on the prompt. 

```{r}

ggplot() +
  geom_line(aes(x = 1:100, y = sim.500$allele.freq), color = "red") +
  geom_line(aes(x = 1:100, y = sim.5000$allele.freq), color = "blue") +
  labs(x = "Generation", y = "Frequency of one Allele at Locus") 

```

## 2b.

For part B, we are asked to start with a single allele and mutate at rate k with another allele. To do this, we adjust the function from part 2a. to allow for a mutation rate k for the probability in rbinom() that illustrates the amount of mutated alleles. We see in the plots that the rate of mutation results in a linear slope for both n = 500 and n = 5000 with a mutation rate of 0.0001 and 0.001. However, as the mutation rate increases up to 0.01, the relationship is more quadratic for both n = 500 and n = 5000. 

```{r}

gens <- 100

simulation2 <- function(n.0, k, offspring.rate = 2.15) {
  n <- numeric(gens)          
  a.freq <- numeric(gens)           
  
  #starting condition
  n[1] <- n.0
  a.freq[1] <- 0                  
  
  #all start with same genotype
  geno <- rep(0, n.0)      
  
  for (i in 2:gens) {
    #population increase
    n[i] <- round(n[i - 1] * offspring.rate / 2) * 2
    #total alleles in next generation
    totals <- 2 * n[i]
    
    n.X <- totals 
    
    if (i > 2) {
      #X alleles before mutation
      n.X <- round(totals * (1 - a.freq[i-1]))
    }
    
    #mutation
    mutated <- rbinom(1, n.X, k)
    
    #total mutated alleles this generation
    a.freq[i] <- (totals - n.X + mutated)/totals
  }
  
  data.frame(generation = 1:gens, n = n, allele.freq = a.freq)
}


set.seed(5)

sim2.500 <- simulation2(500, 0.01)
sim2.5000 <- simulation2(5000, 0.01)
sim2.500.2 <- simulation2(500, 0.001)
sim2.5000.2 <- simulation2(5000, 0.001)
sim2.500.3 <- simulation2(500, 0.0001)
sim2.5000.3 <- simulation2(5000, 0.0001)

p1 <- sim2.500 %>% 
  ggplot(aes(x = generation, y = allele.freq)) +
  geom_line() +
  labs(title = "n = 500, k = 0.01") +
  theme(plot.title = element_text(size = 10))

p4 <- sim2.5000 %>% 
  ggplot(aes(x = generation, y = allele.freq)) +
  geom_line() +
  labs(title = "n = 5000, k = 0.01")+
  theme(plot.title = element_text(size = 10))

p2 <- sim2.500.2 %>% 
  ggplot(aes(x = generation, y = allele.freq)) +
  geom_line() +
  labs(title = "n = 500, k = 0.001")+
  theme(plot.title = element_text(size = 10))

p5 <- sim2.5000.2 %>% 
  ggplot(aes(x = generation, y = allele.freq)) +
  geom_line() +
  labs(title = "n = 5000, k = 0.001")+
  theme(plot.title = element_text(size = 10))

p3 <- sim2.500.3 %>% 
  ggplot(aes(x = generation, y = allele.freq)) +
  geom_line() +
  labs(title = "n = 500, k = 0.0001")+
  theme(plot.title = element_text(size = 10))

p6 <- sim2.5000.3 %>% 
  ggplot(aes(x = generation, y = allele.freq)) +
  geom_line() +
  labs(title = "n = 5000, k = 0.0001")+
  theme(plot.title = element_text(size = 10))

grid.arrange(p1, p2, p3, p4, p5, p6, ncol = 3)

```

