---
title: "Homework 06"
author: "Joe Dickerson"
date: "2026-02-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, error=FALSE}

## packages
library(ISLR)
library(tidyverse)

```
## 1.

We see volume trend upward as the years progress. Categorizing the point color by Direction variable does not seem to illustrate any information, though the correlation matrix does also indicate a relationship between Year and Volume with a value of 0.842.

```{r}

data(Weekly)

head(Weekly)

Weekly |> 
  ggplot(aes(x = Year, y = Volume, color = Direction)) +
  geom_point()

plot(Weekly$Year, Weekly$Volume)

cor(Weekly[,-9])


```

## 2.

We see that Lag2 is statistically significant with a p-value of 0.0296, however no other predictors show statistical significance.

```{r}

glmod <- glm(Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume, data = Weekly, family  = binomial)

summary(glmod)

```

## 3.

We see that the prediction model had 54 correct predictions of downward returns, and 557 correct predictions of upward returns There were 48 incorrect predictions of upward returns, and 430 incorrect predictions of downward returns.

We combine the amount of correct predictions over the total amount of predictions and see that the rate of correct predictions is 0.56. This tells us that the predictive model is correct roughly a little more than half of instances. 

```{r}

glm.probs <- predict(glmod, type = "response")
glm.probs [1:10]

glm.pred <- rep("Down", 1089)
glm.pred[glm.probs > .5] <- "Up"

table(glm.pred, Weekly$Direction)

(557 + 54) / 1089

```

## 4.

We create a training data set using the period 1990 to 2008 and refit the model using only Lag2 as a predictor on the training data. Then a test data set is made with the years 2009 and 2010. After computing the confusion matrix, we find the rate of correct predictions to be 0.63, which is 0.7 higher than the previous model including more predictors and all the years of data. 

```{r}

train <- (Weekly$Year < 2009)
test <- Weekly[!train, ]

Direction.2009 <- Weekly$Direction[!train]

glmod2 <- glm(Direction ~ Lag2, data = Weekly, family = binomial, subset = train)

glm.probs2 <- predict(glmod2, test, type = "response")
glm.pred2 <- rep("Down", 104)
glm.pred2[glm.probs2 > .5] <- "Up"

table(glm.pred2, Direction.2009)
(9 + 56)/104
mean(glm.pred2==Direction.2009)

```