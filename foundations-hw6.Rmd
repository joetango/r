---
title: "Homework 06"
author: "Joe Dickerson"
date: "2026-02-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, error=FALSE}

## packages
library(ISLR)
library(tidyverse)



```
## 1.

```{r}

data(Weekly)

head(Weekly)

Weekly |> 
  ggplot(aes(x = Year, y = Volume, color = Direction)) +
  geom_point()

plot(Weekly$Volume)

cor(Weekly[,-9])


```

## 2.

We see that Lag2 is statistically significant with a p-value of 0.0296, however no other predictors show statistical significance.

```{r}

glmod <- glm(Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume, data = Weekly, family  = binomial)

summary(glmod)

```

## 3.

We see that the prediction model had 54 correct predictions of downward returns, and 557 correct predictions of upward returns There were 48 incorrect predictions of upward returns, and 430 incorrect predictions of downward returns.

We combine the amount of correct predictions over the total amount of predictions and see that the rate of correct predictions is 0.56. This tells us that the predictive model is correct roughly a little more than half of instances. 

```{r}

glm.probs <- predict(glmod, type = "response")
glm.probs [1:10]

glm.pred <- rep("Down", 1089)
glm.pred[glm.probs > .5] = "Up"

table(glm.pred, Weekly$Direction)

(557 + 54) / 1089

```

## 4.



```{r}

train <- (Weekly$Year < 2009)
Weekly.train <- Weekly[train, ]

Direction.1990.2008 <- Weekly$Direction[train]

glm.fit <- glm(Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume, data = Weekly, family = binomial, subset = train)
glm.probs =predict (glm.fit ,Smarket.2005 , type="response")
glm.pred=rep ("Down" ,252)
glm.pred[glm.probs >.5]="Up"
table(glm.pred ,Direction.2005)
mean(glm.pred== Direction.2005)

```